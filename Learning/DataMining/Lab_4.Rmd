---
title: "Зелимхан Гудиев. Лабораторная №4"
output: html_document
date: "2022-11-01"
---

# Лабораторная работа по теме «Анализ социальных сетей»

Исходные данные: в двух файлах содержатся данные об актерах и фильмах с их участием (actors.csv и movies.csv, соответственно). Так, данные об актерах содержат, в частности, информацию, присуждался ли актеру титул «лучший актер» или «лучшая актриса» в рамках Academy Award. 
1. Импортируйте данные в R, используя библиотеку readr, например:
```{r setup, include=FALSE}
library(readr)
library(dplyr)
path_dir <- getwd()
actors <- read_csv(paste0(path_dir, "/actors.csv"))
movies <- read_csv(paste0(path_dir, "/movies.csv"))
```

2. Создайте граф на основе данных об актерах, таким образом, чтобы в качестве рёбер графа использовались фильмы:
```{r}
library(igraph)
set.seed(100)
myGraph <- graph_from_data_frame(d = movies, vertices = actors, directed = F)
```


3. Используя цветовую кодировку, изобразите актеров, игравших совместно в фильме The Rock, и постройте полученный граф:
```{r}
movies <- E(myGraph)$Movie 
E(myGraph)$color <- case_when(movies == "The Rock" ~ "orange",
                              movies == "Apollo 13" ~ "green",
                              movies == "Forrest Gump" ~ "black",
                              movies == "Titanic"~ "blue")
  
plot(myGraph)
```
Сделайте выводы.\
**Ответ:**\
*Актеры, игравшие в фильме The Rock, соединены ребрами оранжевого цвета - это Ed Harris, Sean Connery, Nicholas Cage.*\

4. Добавьте на граф две легенды: выделение цветом полученных совместных связей из предыдущего задания и выделение цветом номинантов на лучшего актера/актрису и победителей:
```{r}
win_colors <- ifelse(actors$BestActorActress == "Winner", "gold", 
                     ifelse(actors$BestActorActress == "Nominated", "gray", 
                            "lightblue"))

plot(myGraph, vertex.frame.color = "white", vertex.color = win_colors)

legend("bottomright", c("Winner","Nominee", "Not Nominated"), pch=21,
	col = "#777777", pt.bg = c("gold","grey","lightblue"), pt.cex = 2, cex = .8)

legend("topleft", c("The Rock", "Apollo 13", "Forrest Gump", "Titanic"), 
	col = c("orange","green","black", "blue"), lty = 1, cex = .8)
```

5. Вычислите и представьте степени центральности (centrality):
```{r}
degree(myGraph, mode = "all") %>% sort()
```

Укажите актеров с наименьшей центральностью. Сделайте выводы. В частности, что означает центральность в данном случае с точки зрения ролей в фильмах?\
**Ответ:**\
*Актеры с наименьшей центральностью: Robin Wright, Sean Connery, Nicholas Cage. Эти актеры сыграли в одном фильме с наименьшим количеством других актеров. Центральность характеризует количество пересечений (социальных взаимодействий) с другмими актерами на съемочных площадках.*\

6. Вычислите относительные степени близости (closeness):
```{r}
closeness(myGraph, mode = "all", weights = NA, normalized = T) %>% 
  sort(decreasing = TRUE)
```

Интерпретируйте полученные результаты. В частности, укажите актера с наибольшей степенью близости к другим узлам графа.\

**Ответ:**\
*Актер с наибольшей степенью близости - Bill Paxton.*\

Какова звенность (сколько звеньев (ребер графа) необходимо пройти) у Билла Пакстона по отношению к:\
- Тому Хэнксу;      **Ответ:** *- одно ребро*\
- Эду Харрису;      **Ответ:** *- одно ребро*\
- Робину Райту;     **Ответ:** *- два ребра*\
- Николасу Кейджу;  **Ответ:** *- два ребра*\
- Шону Коннери      **Ответ:** *- два ребра*\
Есть ли актеры со звенностью более 2? Если да, укажите по крайней мере одного актера и такую связь.\
**Ответ:**
*Для Билла Пакстона актеров со звенностью более 2-х нет. Но, например, для  Николоса Кейджа чтобы добраться до Кейт Уинслетт нужно пройти три ребра:  Nicholas Cage ->1-> Ed Harris ->2-> Bill Paxton ->3-> Kate Winslet. *\
Есть ли актеры со звенностью более 3?\
**Ответ:**
*Таких актеров нет.*\

7. Вычислите степени посредничества (betweenness):
```{r}
betweenness(myGraph, directed = F, weights = NA, normalized = T) %>% 
  sort(decreasing = TRUE)
```

Существуют ли звенья (вершины) графа с высокой степенью посредничества, т.е. оказывающиеся на пути к другим звеньям, и, возможно, представляющие собой «узкие места» либо узловые точки передачи информации (возможно, фильтры)? Укажите этих актеров и их степень посредничества.\
**Ответ:**
*Актерами с высокой степенью посредничества являются Bill Paxton (0.47) и Ed Harris(0.36).*\
В данном примере, обладают ли они высокой или низкой степенью центральности?
Что это может означать?\
**Ответ:**
*В данном примере актеры с высокой степенью посредничества являются также актерами с наибольшей центральностью. Это означает, что чем больше у вершины (актера) социальных связей, тем чаще она становится посредником между другими вершинами.*

8. Вычислите «критерий Бэйкона» для актеров Шона Коннери и какого-либо другого по выбору:
```{r}
distances(myGraph, v = V(myGraph)["Sean Connery"], to = V(myGraph), weights=NA) 
```
```{r}
distances(myGraph, v = V(myGraph)["Bill Paxton"], to = V(myGraph), weights = NA)
```

Вы получили наиболее короткие пути на графе от заданной точки к другим. Укажите по два наибольших и наименьших значений из полученных.\
**Ответ:**
*Наибольшие значения для Шона Коннери - 3 (DiCaprio, Kate Winslet, Billy Zane), для Билла Пакстона - 2 (Wright Bill, Sean Connery, Nicholas Cage). Наименьшие (если не считать саму исходную точку) для Коннери - 1 ( Nicholas Cage), для Пакстона - 1(Leonardo DiCaprio, Kate Winslet, Billy Zane).*